# mvn pom.xml
- [ pom.xml layout ](https://maven.apache.org/ref/3.6.3/maven-model/maven.html)
- [ Super pom.xml ](https://maven.apache.org/ref/3.6.3/maven-model-builder/super-pom.html)
- [ POM reference ](http://maven.apache.org/pom.html)
- [ POM Properties ](https://cwiki.apache.org/confluence/display/MAVEN/Maven+Properties+Guide)

## mvn command
```
mvn <PHASE> [-dskipTests=true]
mvn <PHASE>:<GOAL>
mvn <PLUGIN>:<GOAL>
mvn help:describe -Dcmd=phase-name     #goals linked to the phase
mvn help:describe -DgroupId=plugin-groupId -DartifactId=plugin-artifactId -Ddetail=true   #list of goals for the plugin
```

Maven is based on the build lifecycle. There are 3 built-in build lifecycles:
- default:  handle the project development (23 phases)

| Phase | Description |
|-------|-------------|
|validate |	validate the project is correct and all necessary information is available.|
|initialize |	initialize build state, e.g. set properties or create directories.|
|generate-sources |	generate any source code for inclusion in compilation.|
|process-sources |	process the source code, for example to filter any values.|
|generate-resources |	generate resources for inclusion in the package.|
|process-resources | copy and process the resources into the destination directory, ready for packaging.|
|compile |	compile the source code of the project.|
|process-classes |	post-process the generated files from compilation, for example to do bytecode enhancement on Java classes.|
|generate-test-sources |	generate any test source code for inclusion in compilation.|
|process-test-sources |	process the test source code, for example to filter any values.|
|generate-test-resources |	create resources for testing.|
|process-test-resources |	copy and process the resources into the test destination directory.|
|test-compile |	compile the test source code into the test destination directory|
|process-test-classes |	post-process the generated files from test compilation, for example to do bytecode enhancement on Java classes.|
|test |	run tests using a suitable unit testing framework. These tests should not require the code be packaged or deployed.|
|prepare-package |	perform any operations necessary to prepare a package before the actual packaging. This often results in an unpacked, processed version of the package.|
|package |	take the compiled code and package it in its distributable format, such as a JAR.|
|pre-integration-test |	perform actions required before integration tests are executed. This may involve things such as setting up the required environment.|
|integration-test |	process and deploy the package if necessary into an environment where integration tests can be run.|
|post-integration-test | perform actions required after integration tests have been executed. This may including cleaning up the environment.|
|verify | run any checks to verify the package is valid and meets quality criteria.|
|install |	install the package into the local repository, for use as a dependency in other projects locally.|
|deploy |	done in an integration or release environment, copies the final package to the remote repository for sharing with other developers and projects.|

- clean: clean the project (3 phases: pre-clean; clean; post-clean) 

| Phase | Description |
|-------|-------------|
|pre-clean | execute processes needed prior to the actual project cleaning|
|clean | remove all files generated by the previous build|
|post-clean | execute processes needed to finalize the project cleaning |

- site: build the project's web site 

| Phase |	Description |
|-------|---------------|
|pre-site |	execute processes needed prior to the actual project site generation|
|site |	generate the project's site documentation|
|post-site | execute processes needed to finalize the site generation, and to prepare for site deployment |
|site-deploy | deploy the generated site documentation to the specified web server|

For some defined [**Packaging**](https://maven.apache.org/guides/introduction/introduction-to-the-lifecycle.html#built-in-lifecycle-bindings) type, there are some default plugin and goals attached:

A lifecycle consists a list of pre-ordered phases. Each lifecycles has a list of pre-defineds phases.

A Plugin provides a list of Goals. Each goal can have a default phase, and can be attached to a specific lifecycle's phase. So the execution of a phase will execute a list of attched goals in the order that they are attached.

The attachment of Plugin Goal and Lifecycle Phase could be in \<plugins>\<plugin>...\</plugin>\</plugins> or \<pluginManagement>\<plugin>...\</plugin>\</pluginManagement> within \<build> in profile or main pom.
    
- For plugin is in \<plugins>, it is used locally, can not be referenced in other places or in the sub-pom files
- For plugin is in \<pluginManagement>, it is used globally, can be referenced/shared in other places or in the sub-pom files

```
<build>
    <plugins>
        <plugin>
            <artifactId>maven-xxx-plugin</artifactId>
            <version>${maven.xxx.version}</version>
            <executions>
                <execution>
                    <id>exec-id</id> 
                    <phase>package</package> 
                    <goals>
                        <goal>goal1</goal>
                        <goal>goal2</goal>
                    </goals>
                    <configuration>
                    </configuration>
                </execution>*
            </executions>
            <configuration>
            </configuration>
        </plugin>*
    </plugins>

    <pluginManagement>
         <plugin>
         </plugin>*
    </pluginManagement>
</build>
```

## Concepts
- Goal 

The single unit of task which does some real work. For example the compile goal (runs as  mvn compiler:compile) compiles the Java source. 
All goals are provided by plugins, either by default plugins or by user defined plugins (configured in pom file).

- Phase

A group of ordered goals. Zero or more plugin goals are bound to a phase (either by default or by user). 
For example the compile phase (runs as "mvn compile") consists only compiler:compile goal (plugin). 
Running a phase basically runs the plugins bound with it.

- Build Lifecycle: 

A group of ordered phases. There are three built-in lifecycle: default, clean and site. 

- Maven Plugin 

A Maven plugin is a group of goals


## [ Life Cycle ](https://maven.apache.org/guides/introduction/introduction-to-the-lifecycle.html)
There are three built-in life cycles. [ @see the attached Phases ](http://maven.apache.org/guides/introduction/introduction-to-the-lifecycle.html#Lifecycle%5FReference):

- default: the main life cycle as it's responsible for project deployment
- clean: to clean the project and remove all files generated by the previous build
- site: to create the project's site documentation

## Properties
They come in five different styles:
- env.X: Prefixing a variable with "env." will return the shell's environment variable. For example, ${env.PATH} contains the PATH environment variable.
- project.x: A dot (.) notated path in the POM will contain the corresponding element's value. For example: <project><version>1.0</version></project> is accessible via ${project.version}.
- settings.x: A dot (.) notated path in the settings.xml will contain the corresponding element's value. For example: <settings><offline>false</offline></settings> is accessible via ${settings.offline}.
- Java System Properties: All properties accessible via java.lang.System.getProperties() are available as POM properties, such as ${java.home}.
- x: Set within a <properties /> element in the POM. The value of <properties><someVar>value</someVar></properties> may be used as ${someVar}.
    
## executions - execution
- [Guide](https://maven.apache.org/guides/mini/guide-default-execution-ids.html)
- [Configurations](http://maven.apache.org/guides/mini/guide-configuring-plugins.html)
